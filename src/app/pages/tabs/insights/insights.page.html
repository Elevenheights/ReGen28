<ion-content class="bg-neutral-50">
	<!-- Pull to refresh -->
	<ion-refresher slot="fixed" (ionRefresh)="handleRefresh($event)">
		<ion-refresher-content></ion-refresher-content>
	</ion-refresher>

	<!-- Loading state (Skeletons) -->
	<div *ngIf="isLoading" class="pb-24 px-4 animate-entry">
		<!-- Header Skeleton -->
		<div class="mt-4 mb-8">
			<div class="w-24 h-4 bg-neutral-200 rounded-full animate-pulse mb-2"></div>
			<div class="w-48 h-8 bg-neutral-200 rounded-full animate-pulse mb-6"></div>
			<div
				class="bg-neutral-200/50 backdrop-blur-xl rounded-[2.5rem] h-44 w-full p-6 border border-neutral-100 animate-pulse">
				<div class="flex items-center justify-between mb-6">
					<div class="flex items-center space-x-3">
						<div class="w-12 h-12 bg-neutral-200 rounded-2xl"></div>
						<div class="space-y-2">
							<div class="w-20 h-2 bg-neutral-200 rounded-full"></div>
							<div class="w-32 h-4 bg-neutral-200 rounded-full"></div>
						</div>
					</div>
					<div class="w-16 h-8 bg-neutral-200 rounded-xl"></div>
				</div>
				<div class="w-full h-2.5 bg-neutral-200 rounded-full"></div>
			</div>
		</div>

		<!-- Guidance Skeleton -->
		<div class="mb-8">
			<div class="flex justify-between items-center mb-4">
				<div class="w-32 h-3 bg-neutral-200 rounded-full animate-pulse"></div>
				<div class="w-16 h-5 bg-neutral-200 rounded-full animate-pulse"></div>
			</div>
			<div class="flex space-x-3 overflow-hidden">
				<div class="min-w-[300px] h-44 bg-neutral-100 rounded-3xl animate-pulse"></div>
				<div class="min-w-[100px] h-44 bg-neutral-100 rounded-3xl animate-pulse opacity-50"></div>
			</div>
		</div>

		<!-- Wellness Skeleton -->
		<div class="mb-8">
			<div class="w-24 h-3 bg-neutral-200 rounded-full animate-pulse mb-4"></div>
			<div class="w-full h-64 bg-neutral-100 rounded-[2.5rem] animate-pulse mb-4"></div>
			<div class="grid grid-cols-4 gap-2">
				<div class="h-20 bg-neutral-50 rounded-2xl animate-pulse" *ngFor="let i of [1,2,3,4]"></div>
			</div>
		</div>
	</div>

	<!-- Error state -->
	<div *ngIf="hasGeneralError" class="flex flex-col justify-center items-center h-screen px-6">
		<div
			class="w-20 h-20 bg-gradient-to-br from-red-100 to-red-200 rounded-full flex items-center justify-center mb-6">
			<i class="fa-solid fa-chart-line-down text-red-600 text-2xl"></i>
		</div>
		<h2 class="text-xl font-bold text-neutral-900 mb-3 text-center">Statistics System Unavailable</h2>
		<p class="text-neutral-600 text-center mb-6 leading-relaxed">{{ generalErrorMessage }}</p>
		<button
			class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-full font-semibold active:scale-95 transition-transform"
			(click)="retryDashboardLoad()">
			<i class="fa-solid fa-refresh mr-2"></i>
			Try Again
		</button>
	</div>

	<!-- Main Content -->
	<main *ngIf="!isLoading && !hasGeneralError" class="pb-24">

		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<!-- SECTION 1: WELCOME HEADER                                           -->
		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<app-page-header [title]="getGreeting() + ','" [subtitle]="userDisplayName" theme="indigo" [showProfile]="true"
			[profileUrl]="profileImageUrl" [userName]="userDisplayName">

			<!-- Today's Renewal (Projected) -->
			<div
				class="bg-white/5 backdrop-blur-xl rounded-[2.5rem] p-6 border border-white/10 shadow-2xl animate-entry delay-300">
				<div class="flex items-center justify-between mb-4">
					<div class="flex items-center space-x-3">
						<div
							class="w-12 h-12 bg-gradient-to-br from-amber-400/20 to-orange-500/20 rounded-2xl flex items-center justify-center border border-amber-500/20 shadow-inner">
							<i class="fa-solid fa-sunrise text-amber-400 text-lg"></i>
						</div>
						<div>
							<h3
								class="text-[10px] font-black text-white/40 uppercase tracking-widest leading-none mb-1.5">
								Daily Momentum</h3>
							<p class="text-base font-bold text-white leading-none tracking-tight"><span
									[appCountUp]="dashboardData.analytics.currentStreak"></span> Day Streak</p>
						</div>
					</div>
					<div class="text-right">
						<div class="text-2xl font-black text-white tracking-tighter"><span
								[appCountUp]="getTodayCompletionPercentage()"></span>%</div>
						<div class="text-[9px] text-amber-400 font-bold uppercase tracking-widest opacity-80">flowing
						</div>
					</div>
				</div>
				<div class="w-full bg-white/5 rounded-full h-2.5 overflow-hidden border border-white/5">
					<div class="bg-gradient-to-r from-amber-400 via-orange-500 to-amber-600 h-full rounded-full transition-all duration-1000 ease-out shadow-[0_0_15px_rgba(251,191,36,0.5)]"
						[style.width.%]="getTodayCompletionPercentage()"></div>
				</div>
			</div>
		</app-page-header>

		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<!-- SECTION SEPARATOR                                                    -->
		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<app-section-separator color="emerald"></app-section-separator>

		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<!-- SECTION 2: TODAY'S GUIDANCE (Merged Intentions + Insights)          -->
		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<!-- SECTION 2: TODAY'S GUIDANCE (Merged Intentions + Insights)          -->
		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<section class="px-4 pb-2 animate-entry delay-500">
			<!-- Section Header -->
			<div class="flex items-center justify-between mb-4">
				<h2 class="text-xs font-black text-neutral-400 uppercase tracking-widest flex items-center space-x-2">
					<i class="fa-solid fa-compass text-emerald-600"></i>
					<span>Today's Guidance</span>
				</h2>
				<div class="flex items-center space-x-2">
					<div
						class="flex items-center bg-gradient-to-r from-emerald-100 to-teal-100 rounded-full px-3 py-1 shadow-sm">
						<i class="fa-solid fa-wand-magic-sparkles text-emerald-600 text-[10px]"></i>
						<span class="text-[10px] text-emerald-700 font-extrabold ml-1 uppercase">AI Powered</span>
					</div>
				</div>
			</div>

			<!-- State 1: No Active Trackers -->
			<div *ngIf="!hasActiveTrackers()"
				class="bg-gradient-to-br from-neutral-50 to-neutral-100 rounded-3xl p-6 text-center border border-neutral-200 border-dashed flex flex-col items-center justify-center animate-entry">
				<div class="w-14 h-14 bg-white rounded-2xl flex items-center justify-center mb-4 shadow-sm">
					<i class="fa-solid fa-plus text-2xl text-neutral-400"></i>
				</div>
				<h3 class="text-base font-semibold text-neutral-900 mb-2">Start Your Journey</h3>
				<p class="text-sm text-neutral-500 font-medium max-w-xs mx-auto mb-4 leading-relaxed">
					Add your first tracker to unlock personalized AI guidance and insights.
				</p>
				<button
					class="bg-neutral-900 text-white px-5 py-2.5 rounded-full text-sm font-semibold shadow-md active:scale-95 transition-transform flex items-center space-x-2"
					(click)="addNewTracker()">
					<i class="fa-solid fa-plus text-xs"></i>
					<span>Add Tracker</span>
				</button>
			</div>

			<!-- State 2: Loading Suggestions -->
			<div *ngIf="hasActiveTrackers() && isLoadingSuggestions" class="mb-4">
				<div class="bg-gradient-to-br from-emerald-500/10 to-teal-500/10 rounded-3xl p-6 animate-pulse">
					<div class="flex items-center space-x-3 mb-4">
						<div class="w-10 h-10 bg-emerald-200 rounded-xl"></div>
						<div class="flex-1">
							<div class="h-4 bg-emerald-200 rounded w-3/4"></div>
						</div>
					</div>
					<div class="h-3 bg-emerald-100 rounded w-full mb-2"></div>
					<div class="h-3 bg-emerald-100 rounded w-2/3"></div>
				</div>
			</div>

			<!-- State 3: Active Trackers but No Suggestions (Empty State) -->
			<div *ngIf="hasActiveTrackers() && !isLoadingSuggestions && !hasAnySuggestions"
				class="bg-gradient-to-br from-emerald-50 to-teal-50 rounded-3xl p-6 text-center border border-emerald-100 flex flex-col items-center justify-center animate-entry">
				<div class="w-14 h-14 bg-emerald-100 rounded-2xl flex items-center justify-center mb-4">
					<i class="fa-solid fa-wand-magic-sparkles text-2xl text-emerald-600"></i>
				</div>
				<h3 class="text-base font-semibold text-emerald-900 mb-2">Guidance Gathering</h3>
				<p class="text-sm text-emerald-700 font-medium max-w-xs mx-auto mb-4 leading-relaxed">
					Your AI insights are being crafted. Complete your first activity or check back soon!
				</p>
				<button
					class="bg-emerald-600 text-white px-5 py-2.5 rounded-full text-sm font-semibold shadow-sm active:scale-95 transition-transform flex items-center space-x-2"
					(click)="refreshCoaching()">
					<i class="fa-solid fa-rotate-right text-xs"></i>
					<span>Refresh Insights</span>
				</button>
			</div>

			<!-- State 4: Content Available (Horizontal Scroll) -->
			<div *ngIf="hasActiveTrackers() && !isLoadingSuggestions && hasAnySuggestions"
				class="flex space-x-3 overflow-x-auto scrollbar-hide pb-3"
				style="scroll-snap-type: x mandatory; -webkit-overflow-scrolling: touch;">

				<!-- Action Cards -->
				<div *ngFor="let action of dashboardData.todaysActions"
					class="bg-gradient-to-br from-emerald-500 to-teal-600 rounded-3xl p-5 text-white shadow-lg min-w-[300px] max-w-[340px] flex-shrink-0 relative overflow-hidden cursor-pointer active:scale-[0.98] transition-transform"
					style="scroll-snap-align: start;" (click)="toggleActionExpansion(action.id || '', $event)">

					<!-- Background decoration -->
					<div class="absolute top-0 right-0 w-24 h-24 bg-white/10 rounded-full -mr-12 -mt-12"></div>
					<div class="absolute bottom-0 left-0 w-20 h-20 bg-white/10 rounded-full -ml-10 -mb-10"></div>

					<!-- Content -->
					<div class="relative z-10">
						<!-- Tracker header -->
						<div class="flex items-center space-x-3 mb-3">
							<div
								class="w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center backdrop-blur-sm">
								<span class="text-white text-base">{{ action.metadata?.icon || 'ðŸŽ¯' }}</span>
							</div>
							<div class="flex-1">
								<span class="text-sm font-semibold text-white/90">{{ action.source.trackerName }}</span>
							</div>
							<div class="px-2 py-1 bg-white/20 rounded-lg backdrop-blur-sm">
								<span class="text-xs font-medium text-white/80">Action</span>
							</div>
						</div>

						<!-- Action text -->
						<div>
							<p class="text-base font-semibold text-white leading-snug mb-2"
								[class.line-clamp-2]="!isReadingMode">
								{{ action.body }}
							</p>
							<p *ngIf="action.metadata?.reason" class="text-xs text-white/80 leading-relaxed"
								[class.line-clamp-2]="!isReadingMode">
								{{ action.metadata?.reason }}
							</p>
						</div>
					</div>
				</div>

				<!-- Insight Cards -->
				<div *ngFor="let insight of dashboardData.todaysInsights"
					class="bg-white rounded-3xl shadow-md border border-neutral-100 overflow-hidden cursor-pointer active:scale-[0.98] transition-transform min-w-[300px] max-w-[340px] flex-shrink-0 p-5"
					style="scroll-snap-align: start;" (click)="toggleInsightExpansion(insight.id || '', $event)">

					<div class="flex items-center space-x-3 mb-3">
						<div
							class="w-10 h-10 rounded-xl flex items-center justify-center bg-gradient-to-br from-blue-500 to-purple-600 text-white shadow-sm">
							<span class="text-base">{{ insight.metadata?.icon || 'ðŸ“Š' }}</span>
						</div>
						<div class="flex-1 min-w-0">
							<h3 class="text-sm font-semibold text-neutral-900">{{ insight.source.trackerName }}</h3>
							<p class="text-xs text-neutral-600">{{ insight.metadata?.insightType || 'Strategic Insight'
								}}</p>
						</div>
						<div class="px-2 py-1 bg-amber-100 rounded-lg">
							<span class="text-xs font-medium text-amber-700">Insight</span>
						</div>
					</div>

					<!-- Insight text -->
					<div>
						<p class="text-sm text-neutral-700 leading-relaxed font-medium line-clamp-3">
							{{ insight.body }}
						</p>
						<div class="flex items-center space-x-2 mt-3" *ngIf="insight.metadata?.dataPoint">
							<span
								class="inline-block px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-full border border-blue-200 font-semibold">
								{{ insight.metadata?.dataPoint }}
							</span>
						</div>
					</div>
				</div>
			</div>

			<!-- Scroll indicator dots -->
			<div *ngIf="hasActiveTrackers() && !isLoadingSuggestions && hasAnySuggestions"
				class="flex justify-center space-x-1.5 mt-2">
				<div *ngFor="let item of dashboardData.todaysActions.concat(dashboardData.todaysInsights); let i = index"
					class="w-1.5 h-1.5 rounded-full bg-emerald-300"></div>
			</div>
		</section>

		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<!-- SECTION SEPARATOR                                                    -->
		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<app-section-separator color="purple"></app-section-separator>

		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<!-- SECTION 3: YOUR WELLNESS (Merged Energy Flow + Engagement + Growth) -->
		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<section class="px-4 pb-2 animate-entry delay-500">
			<!-- Section Header -->
			<div class="flex items-center justify-between mb-4">
				<h2 class="text-xs font-black text-neutral-400 uppercase tracking-widest flex items-center space-x-2">
					<i class="fa-solid fa-heart-pulse text-purple-600"></i>
					<span>Your Wellness</span>
				</h2>
			</div>

			<!-- Hero Wellness Score Card -->
			<div class="bg-gradient-to-br from-purple-500 to-blue-600 rounded-3xl p-6 text-white shadow-lg mb-4">
				<div class="flex items-center justify-between mb-5">
					<div>
						<h3 class="text-base font-medium text-white/90 mb-1">Your Alignment</h3>
						<div class="text-5xl font-bold"><span
								[appCountUp]="dashboardData.analytics.wellnessScore"></span><span
								class="text-2xl font-normal">/100</span></div>
					</div>
					<div class="w-20 h-20 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center">
						<i class="fa-solid fa-heart text-3xl text-pink-300"></i>
					</div>
				</div>

				<!-- Score breakdown - compact row -->
				<div class="grid grid-cols-3 gap-3">
					<div class="bg-white/15 backdrop-blur-sm rounded-2xl p-3 text-center">
						<i class="fa-solid fa-face-smile text-lg mb-1"></i>
						<div class="text-xs font-medium text-white/80">Mood</div>
						<div class="text-xl font-bold"><span [appCountUp]="dashboardData.analytics.moodData.average"
								[decimalPlaces]="1"></span>/5</div>
					</div>
					<div class="bg-white/15 backdrop-blur-sm rounded-2xl p-3 text-center">
						<i class="fa-solid fa-fire text-lg mb-1"></i>
						<div class="text-xs font-medium text-white/80">Consistency</div>
						<div class="text-xl font-bold"><span
								[appCountUp]="dashboardData.analytics.consistencyRate"></span>%</div>
					</div>
					<div class="bg-white/15 backdrop-blur-sm rounded-2xl p-3 text-center">
						<i class="fa-solid fa-bolt text-lg mb-1"></i>
						<div class="text-xs font-medium text-white/80">Streak</div>
						<div class="text-xl font-bold" [appCountUp]="dashboardData.analytics.currentStreak"></div>
					</div>
				</div>
			</div>

			<!-- Compact Stats Grid -->
			<div class="grid grid-cols-4 gap-2 mb-4">
				<div class="bg-white rounded-2xl p-3 shadow-sm border border-neutral-100 text-center">
					<div class="text-lg font-bold text-blue-600"
						[appCountUp]="dashboardData.trackerStats.totalSessions"></div>
					<div class="text-xs text-neutral-500 font-medium">Sessions</div>
				</div>
				<div class="bg-white rounded-2xl p-3 shadow-sm border border-neutral-100 text-center">
					<div class="text-lg font-bold text-purple-600"
						[appCountUp]="dashboardData.journalStats.totalEntries"></div>
					<div class="text-xs text-neutral-500 font-medium">Journal</div>
				</div>
				<div class="bg-white rounded-2xl p-3 shadow-sm border border-neutral-100 text-center">
					<div class="text-lg font-bold text-orange-500">{{ dashboardData.trackerStats.streak }}ðŸ”¥</div>
					<div class="text-xs text-neutral-500 font-medium">Days</div>
				</div>
				<div class="bg-white rounded-2xl p-3 shadow-sm border border-neutral-100 text-center">
					<div class="text-lg font-bold text-emerald-600">{{ getWeeklyEngagementCount() }}/7</div>
					<div class="text-xs text-neutral-500 font-medium">Active</div>
				</div>
			</div>

			<!-- Inline Weekly Engagement Chart -->
			<div class="bg-white rounded-2xl p-4 shadow-sm border border-neutral-100">
				<div class="flex items-center justify-between mb-3">
					<span class="text-sm font-semibold text-neutral-700">This Week</span>
					<span class="text-xs text-emerald-600 font-medium">{{ getWeeklyEngagementRate() }}</span>
				</div>
				<div class="flex items-end justify-between h-12 mb-2">
					<div class="w-8 bg-gradient-to-t from-emerald-500 to-emerald-400 rounded-t-md transition-all"
						[style.height]="getDailyEngagementHeight(0)"></div>
					<div class="w-8 bg-gradient-to-t from-emerald-500 to-emerald-400 rounded-t-md transition-all"
						[style.height]="getDailyEngagementHeight(1)"></div>
					<div class="w-8 bg-gradient-to-t from-emerald-500 to-emerald-400 rounded-t-md transition-all"
						[style.height]="getDailyEngagementHeight(2)"></div>
					<div class="w-8 bg-gradient-to-t from-emerald-500 to-emerald-400 rounded-t-md transition-all"
						[style.height]="getDailyEngagementHeight(3)"></div>
					<div class="w-8 bg-gradient-to-t from-emerald-500 to-emerald-400 rounded-t-md transition-all"
						[style.height]="getDailyEngagementHeight(4)"></div>
					<div class="w-8 bg-gradient-to-t from-emerald-500 to-emerald-400 rounded-t-md transition-all"
						[style.height]="getDailyEngagementHeight(5)"></div>
					<div class="w-8 bg-gradient-to-t from-emerald-500 to-emerald-400 rounded-t-md transition-all"
						[style.height]="getDailyEngagementHeight(6)"></div>
				</div>
				<div class="flex items-center justify-between text-xs text-neutral-500 font-medium">
					<span>M</span><span>T</span><span>W</span><span>T</span><span>F</span><span>S</span><span>S</span>
				</div>
			</div>
		</section>

		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<!-- SECTION SEPARATOR                                                    -->
		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<app-section-separator color="blue"></app-section-separator>

		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<!-- SECTION 4: MIND & TRACKERS                                          -->
		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<section class="px-4 pb-2">
			<!-- Section Header -->
			<div class="flex items-center justify-between mb-4">
				<h2 class="text-lg font-semibold text-neutral-900 flex items-center space-x-2">
					<i class="fa-solid fa-leaf text-emerald-600"></i>
					<span>Mind Check-In</span>
				</h2>
				<div class="flex items-center bg-neutral-100 rounded-full p-1">
					<button class="text-xs px-3 py-1.5 rounded-full font-medium transition-colors"
						[class.bg-white]="moodChartTimeframe === 'week'"
						[class.text-neutral-700]="moodChartTimeframe === 'week'"
						[class.shadow-sm]="moodChartTimeframe === 'week'"
						[class.text-neutral-500]="moodChartTimeframe !== 'week'"
						(click)="setMoodChartTimeframe('week')">Week</button>
					<button class="text-xs px-3 py-1.5 rounded-full font-medium transition-colors"
						[class.bg-white]="moodChartTimeframe === 'month'"
						[class.text-neutral-700]="moodChartTimeframe === 'month'"
						[class.shadow-sm]="moodChartTimeframe === 'month'"
						[class.text-neutral-500]="moodChartTimeframe !== 'month'"
						(click)="setMoodChartTimeframe('month')">Month</button>
				</div>
			</div>

			<!-- Mood Chart Card -->
			<div class="bg-white rounded-3xl p-5 shadow-md border border-neutral-100 mb-4">
				<div class="flex items-center justify-between mb-4">
					<span class="text-base font-semibold text-neutral-800">This {{ moodChartTimeframe | titlecase }}'s
						Mood</span>
					<span class="text-xs text-emerald-600 bg-emerald-50 px-3 py-1.5 rounded-full font-medium">{{
						getMoodTrendLabel() }}</span>
				</div>

				<!-- Mood Chart Visualization -->
				<div class="relative h-28 mb-4">
					<!-- Empty State -->
					<div *ngIf="!hasMoodData()"
						class="absolute inset-0 flex flex-col items-center justify-center bg-neutral-50 rounded-xl border border-dashed border-neutral-200">
						<i class="fa-solid fa-cloud text-neutral-300 text-2xl mb-2"></i>
						<p class="text-xs text-neutral-400 font-medium">No mood data yet</p>
						<button
							class="mt-2 text-xs font-semibold text-emerald-600 bg-white border border-emerald-100 px-3 py-1 rounded-full shadow-sm"
							(click)="logMood()">Log Mood</button>
					</div>

					<!-- Chart Content -->
					<ng-container *ngIf="hasMoodData()">
						<div class="absolute inset-0 flex flex-col justify-between">
							<div class="border-t border-neutral-100"></div>
							<div class="border-t border-neutral-100"></div>
							<div class="border-t border-neutral-100"></div>
							<div class="border-t border-neutral-100"></div>
							<div class="border-t border-neutral-200"></div>
						</div>
						<svg class="absolute inset-0 w-full h-full" viewBox="0 0 280 120">
							<defs>
								<linearGradient id="moodGradient" x1="0%" y1="0%" x2="0%" y2="100%">
									<stop offset="0%" style="stop-color:#10b981;stop-opacity:0.3" />
									<stop offset="100%" style="stop-color:#10b981;stop-opacity:0" />
								</linearGradient>
							</defs>
							<path *ngIf="getMoodAreaPath()" [attr.d]="getMoodAreaPath()" fill="url(#moodGradient)" />
							<path *ngIf="getMoodPath()" [attr.d]="getMoodPath()" stroke="#10b981" stroke-width="3"
								fill="none" />
							<circle *ngFor="let point of getMoodPoints()" [attr.cx]="point.cx" [attr.cy]="point.cy"
								r="4" fill="#10b981" />
						</svg>
					</ng-container>
				</div>

				<!-- Day labels -->
				<div class="flex items-center justify-between text-xs text-neutral-500">
					<span>Mon</span><span>Tue</span><span>Wed</span><span>Thu</span><span>Fri</span><span>Sat</span><span>Sun</span>
				</div>

				<!-- Mood insights -->
				<div class="mt-4 p-4 bg-gradient-to-r from-amber-50 to-orange-50 rounded-2xl">
					<div class="flex items-start space-x-3">
						<div class="w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center flex-shrink-0">
							<i class="fa-solid fa-lightbulb text-amber-600"></i>
						</div>
						<span class="text-sm text-amber-900 font-medium leading-relaxed">{{ getMoodInsightText()
							}}</span>
					</div>
				</div>
			</div>

			<!-- Top Performing Trackers -->
			<div class="bg-white rounded-3xl p-5 shadow-md border border-neutral-100">
				<h3 class="text-base font-semibold text-neutral-800 mb-4">Top Performing Trackers</h3>
				<div class="space-y-3">
					<div *ngFor="let tracker of getTopTrackers()"
						class="flex items-center justify-between py-2 active:scale-[0.98] transition-transform">
						<div class="flex items-center space-x-3">
							<div class="w-11 h-11 rounded-2xl flex items-center justify-center text-white shadow-sm"
								[style.background]="'linear-gradient(135deg, ' + tracker.color + ', ' + tracker.color + '90)'">
								<i [class]="'fa-solid ' + tracker.icon" class="text-base"></i>
							</div>
							<div>
								<span class="text-sm font-semibold text-neutral-900">{{ tracker.name }}</span>
								<div class="text-xs text-neutral-500 font-medium">{{ tracker.streak || 0 }}-day streak
								</div>
							</div>
						</div>
						<div class="text-right">
							<div class="text-base font-bold" [style.color]="tracker.color">{{
								getTrackerConsistency(tracker) }}%</div>
							<div class="text-xs text-neutral-500 font-medium">consistency</div>
						</div>
					</div>
					<div *ngIf="getTopTrackers().length === 0" class="text-center py-4 text-neutral-500 text-sm">
						No active trackers yet. Start building your habits!
					</div>
				</div>
			</div>
		</section>

		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<!-- SECTION SEPARATOR                                                    -->
		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<app-section-separator color="rose"></app-section-separator>

		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<!-- SECTION 5: PROGRESS OVERVIEW (Categories + Active Goals)            -->
		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<section class="px-4 pb-2">
			<!-- Section Header -->
			<div class="flex items-center justify-between mb-4">
				<h2 class="text-lg font-semibold text-neutral-900 flex items-center space-x-2">
					<i class="fa-solid fa-mountain-sun text-rose-500"></i>
					<span>Progress Overview</span>
				</h2>
				<button class="text-sm text-neutral-500 font-medium active:scale-95 transition-transform"
					(click)="viewCategories()">Explore</button>
			</div>

			<!-- Categories Grid (Compact) -->
			<div class="bg-white rounded-3xl p-4 shadow-md border border-neutral-100 mb-4">
				<div class="grid grid-cols-2 gap-3">
					<div
						class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-2xl p-3.5 relative overflow-hidden">
						<div class="absolute top-0 right-0 w-16 h-16 bg-purple-200/30 rounded-full -mr-8 -mt-8"></div>
						<div class="relative">
							<div class="flex items-center space-x-2 mb-2">
								<div
									class="w-8 h-8 bg-purple-500 rounded-lg flex items-center justify-center shadow-sm">
									<i class="fa-solid fa-brain text-white text-sm"></i>
								</div>
								<span class="text-sm font-semibold text-purple-900">Mind</span>
							</div>
							<div class="text-2xl font-bold text-purple-700"><span
									[appCountUp]="dashboardData.analytics.categoryPerformance.mind"></span>%</div>
						</div>
					</div>

					<div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-2xl p-3.5 relative overflow-hidden">
						<div class="absolute top-0 right-0 w-16 h-16 bg-blue-200/30 rounded-full -mr-8 -mt-8"></div>
						<div class="relative">
							<div class="flex items-center space-x-2 mb-2">
								<div class="w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center shadow-sm">
									<i class="fa-solid fa-heart text-white text-sm"></i>
								</div>
								<span class="text-sm font-semibold text-blue-900">Body</span>
							</div>
							<div class="text-2xl font-bold text-blue-700"><span
									[appCountUp]="dashboardData.analytics.categoryPerformance.body"></span>%</div>
						</div>
					</div>

					<div
						class="bg-gradient-to-br from-amber-50 to-amber-100 rounded-2xl p-3.5 relative overflow-hidden">
						<div class="absolute top-0 right-0 w-16 h-16 bg-amber-200/30 rounded-full -mr-8 -mt-8"></div>
						<div class="relative">
							<div class="flex items-center space-x-2 mb-2">
								<div class="w-8 h-8 bg-amber-500 rounded-lg flex items-center justify-center shadow-sm">
									<i class="fa-solid fa-wand-magic-sparkles text-white text-sm"></i>
								</div>
								<span class="text-sm font-semibold text-amber-900">Soul</span>
							</div>
							<div class="text-2xl font-bold text-amber-700"><span
									[appCountUp]="dashboardData.analytics.categoryPerformance.soul"></span>%</div>
						</div>
					</div>

					<div class="bg-gradient-to-br from-rose-50 to-rose-100 rounded-2xl p-3.5 relative overflow-hidden">
						<div class="absolute top-0 right-0 w-16 h-16 bg-rose-200/30 rounded-full -mr-8 -mt-8"></div>
						<div class="relative">
							<div class="flex items-center space-x-2 mb-2">
								<div class="w-8 h-8 bg-rose-500 rounded-lg flex items-center justify-center shadow-sm">
									<i class="fa-solid fa-spa text-white text-sm"></i>
								</div>
								<span class="text-sm font-semibold text-rose-900">Beauty</span>
							</div>
							<div class="text-2xl font-bold text-rose-700"><span
									[appCountUp]="dashboardData.analytics.categoryPerformance.beauty"></span>%</div>
						</div>
					</div>
				</div>
			</div>

			<!-- Active Goals -->
			<div *ngIf="dashboardData.activeGoals.length > 0" class="space-y-3">
				<div class="flex items-center justify-between">
					<h3 class="text-sm font-semibold text-neutral-700 flex items-center space-x-2">
						<i class="fa-solid fa-bullseye text-blue-600"></i>
						<span>Active Goals</span>
					</h3>
					<button class="text-xs text-neutral-500 font-medium" (click)="viewAllGoals()">View all</button>
				</div>
				<div *ngFor="let goal of dashboardData.activeGoals.slice(0, 2)"
					class="bg-white rounded-2xl p-4 shadow-sm border border-neutral-100 active:scale-[0.98] transition-transform"
					(click)="viewAllGoals()">
					<div class="flex items-center justify-between mb-2">
						<div class="flex items-center space-x-3">
							<div class="w-9 h-9 rounded-xl flex items-center justify-center" [ngClass]="{
								'bg-blue-50 text-blue-600': goal.category === 'mind',
								'bg-green-50 text-green-600': goal.category === 'body',
								'bg-purple-50 text-purple-600': goal.category === 'soul',
								'bg-rose-50 text-rose-600': goal.category === 'beauty',
								'bg-amber-50 text-amber-600': goal.category === 'custom' || !goal.category
							}">
								<i class="fa-solid text-sm" [ngClass]="{
									'fa-brain': goal.category === 'mind',
									'fa-dumbbell': goal.category === 'body',
									'fa-heart': goal.category === 'soul',
									'fa-wand-magic-sparkles': goal.category === 'beauty',
									'fa-bullseye': goal.category === 'custom' || !goal.category
								}"></i>
							</div>
							<span class="text-sm font-semibold text-neutral-900">{{ goal.title }}</span>
						</div>
						<span class="text-xs font-bold text-blue-600 bg-blue-50 px-2 py-1 rounded-lg">{{ goal.progress
							}}%</span>
					</div>
					<div class="w-full bg-neutral-100 h-1.5 rounded-full overflow-hidden">
						<div class="bg-blue-600 h-full rounded-full transition-all duration-500"
							[style.width.%]="goal.progress"></div>
					</div>
				</div>
			</div>
		</section>

		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<!-- SECTION SEPARATOR                                                    -->
		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<app-section-separator color="amber"></app-section-separator>

		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<!-- SECTION 6: TIMELINE & TOOLS                                         -->
		<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
		<section class="px-4 pb-2">
			<!-- Recent Activity -->
			<div class="mb-6">
				<div class="flex items-center justify-between mb-4">
					<h2 class="text-lg font-semibold text-neutral-900 flex items-center space-x-2">
						<i class="fa-solid fa-clock-rotate-left text-amber-600"></i>
						<span>Recent Activity</span>
					</h2>
					<button class="text-sm text-neutral-500 font-medium active:scale-95 transition-transform"
						(click)="viewAllActivities()">View all</button>
				</div>

				<!-- Empty state -->
				<div *ngIf="dashboardData.recentActivities.length === 0"
					class="bg-gradient-to-br from-amber-50 to-orange-100 rounded-3xl p-6 shadow-sm text-center">
					<div class="w-14 h-14 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-4">
						<i class="fa-solid fa-seedling text-2xl text-amber-600"></i>
					</div>
					<h3 class="text-base font-semibold text-amber-900 mb-2">Start Your Journey</h3>
					<p class="text-sm text-amber-700 font-medium">Your first activities will appear here</p>
				</div>

				<!-- Activities list -->
				<div *ngIf="dashboardData.recentActivities.length > 0" class="space-y-3">
					<div *ngFor="let activity of dashboardData.recentActivities.slice(0, 4); trackBy: trackActivity"
						class="bg-white rounded-2xl p-4 shadow-sm border border-neutral-100 flex items-center space-x-3">
						<div class="w-11 h-11 rounded-xl flex items-center justify-center shadow-sm"
							[ngClass]="getActivityGradientClass(activity.type)">
							<i [class]="getActivityIcon(activity.type)" class="text-white text-base"></i>
						</div>
						<div class="flex-1 min-w-0">
							<h3 class="text-sm font-semibold text-neutral-900 truncate">{{ activity.title }}</h3>
							<p class="text-xs text-neutral-500 font-medium">{{ formatActivityTime(activity.createdAt) }}
							</p>
						</div>
						<div class="w-7 h-7 bg-emerald-100 rounded-full flex items-center justify-center">
							<i class="fa-solid fa-check text-emerald-600 text-xs"></i>
						</div>
					</div>
				</div>
			</div>

			<!-- Wellness Tools Grid -->
			<div class="mb-6">
				<h2 class="text-lg font-semibold text-neutral-900 mb-4 flex items-center space-x-2">
					<i class="fa-solid fa-hands-praying text-purple-600"></i>
					<span>Quick Actions</span>
				</h2>
				<div class="grid grid-cols-2 gap-3">
					<!-- Log Mood -->
					<button
						class="bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl p-4 text-white shadow-md active:scale-[0.97] transition-transform relative overflow-hidden"
						(click)="logMood()">
						<div class="absolute top-0 right-0 w-16 h-16 bg-white/10 rounded-full -mr-8 -mt-8"></div>
						<div class="relative z-10 text-center">
							<div class="w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center mx-auto mb-2">
								<i class="fa-solid fa-smile text-white text-lg"></i>
							</div>
							<h3 class="text-sm font-semibold text-white">Log Mood</h3>
						</div>
					</button>

					<!-- Breathe -->
					<button
						class="bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl p-4 text-white shadow-md active:scale-[0.97] transition-transform relative overflow-hidden"
						(click)="openBreathe()">
						<div class="absolute top-0 right-0 w-16 h-16 bg-white/10 rounded-full -mr-8 -mt-8"></div>
						<div class="relative z-10 text-center">
							<div class="w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center mx-auto mb-2">
								<i class="fa-solid fa-wind text-white text-lg"></i>
							</div>
							<h3 class="text-sm font-semibold text-white">Breathe</h3>
						</div>
					</button>

					<!-- Log Activity -->
					<button
						class="bg-gradient-to-br from-purple-500 to-pink-600 rounded-2xl p-4 text-white shadow-md active:scale-[0.97] transition-transform relative overflow-hidden"
						(click)="openQuickLogModal()">
						<div class="absolute top-0 right-0 w-16 h-16 bg-white/10 rounded-full -mr-8 -mt-8"></div>
						<div class="relative z-10 text-center">
							<div class="w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center mx-auto mb-2">
								<i class="fa-solid fa-chart-simple text-white text-lg"></i>
							</div>
							<h3 class="text-sm font-semibold text-white">Log Activity</h3>
						</div>
					</button>

					<!-- Journal -->
					<button
						class="bg-gradient-to-br from-amber-500 to-orange-600 rounded-2xl p-4 text-white shadow-md active:scale-[0.97] transition-transform relative overflow-hidden"
						(click)="openJournalEntry()">
						<div class="absolute top-0 right-0 w-16 h-16 bg-white/10 rounded-full -mr-8 -mt-8"></div>
						<div class="relative z-10 text-center">
							<div class="w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center mx-auto mb-2">
								<i class="fa-solid fa-book text-white text-lg"></i>
							</div>
							<h3 class="text-sm font-semibold text-white">Journal</h3>
						</div>
					</button>
				</div>
			</div>

			<!-- Daily Inspiration (Sacred Wisdom) - Auto-rotating Slideshow -->
			<div
				*ngIf="hasActiveTrackers() && hasAnySuggestions && !isLoadingSuggestions && getAllMotivationalQuotes().length > 0">
				<h2 class="text-lg font-semibold text-neutral-900 mb-4 flex items-center space-x-2">
					<i class="fa-solid fa-lotus text-amber-600"></i>
					<span>Daily Inspiration</span>
				</h2>

				<!-- Slideshow Container -->
				<div class="relative">
					<!-- Quote Card with fade transition -->
					<div class="bg-gradient-to-br from-amber-500 to-orange-600 rounded-3xl p-6 text-white shadow-lg relative overflow-hidden transition-opacity duration-500"
						[class.opacity-100]="!isQuoteTransitioning" [class.opacity-0]="isQuoteTransitioning">
						<!-- Decorative elements -->
						<div class="absolute top-0 right-0 w-28 h-28 bg-white/10 rounded-full -mr-14 -mt-14"></div>
						<div class="absolute bottom-0 left-0 w-20 h-20 bg-white/10 rounded-full -ml-10 -mb-10"></div>
						<div class="absolute top-3 left-4 text-3xl text-white/30 font-serif leading-none">"</div>
						<div
							class="absolute bottom-3 right-4 text-3xl text-white/30 font-serif leading-none rotate-180">
							"</div>

						<!-- Quote Content -->
						<div class="relative z-10 pt-4 pb-2 px-2">
							<blockquote class="text-base font-semibold leading-snug mb-4 text-center min-h-[60px]">
								{{ getCurrentQuote()?.text }}
							</blockquote>
							<div class="text-center">
								<cite class="text-white/90 not-italic font-medium text-sm">
									â€” {{ getCurrentQuote()?.author }}
								</cite>
							</div>
						</div>

						<!-- Navigation arrows (only show if multiple quotes) -->
						<div *ngIf="getAllMotivationalQuotes().length > 1"
							class="absolute inset-y-0 left-0 right-0 flex items-center justify-between px-2 pointer-events-none">
							<button
								class="w-8 h-8 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm pointer-events-auto active:scale-90 transition-transform"
								(click)="previousQuote()">
								<i class="fa-solid fa-chevron-left text-white text-xs"></i>
							</button>
							<button
								class="w-8 h-8 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm pointer-events-auto active:scale-90 transition-transform"
								(click)="nextQuote()">
								<i class="fa-solid fa-chevron-right text-white text-xs"></i>
							</button>
						</div>
					</div>

					<!-- Indicator dots (only show if multiple quotes) -->
					<div *ngIf="getAllMotivationalQuotes().length > 1" class="flex justify-center space-x-2 mt-3">
						<button *ngFor="let quote of getAllMotivationalQuotes(); let i = index"
							class="w-2 h-2 rounded-full transition-all duration-300"
							[class.bg-amber-500]="i === currentQuoteIndex" [class.w-4]="i === currentQuoteIndex"
							[class.bg-neutral-300]="i !== currentQuoteIndex" (click)="goToQuote(i)">
						</button>
					</div>
				</div>
			</div>
		</section>



	</main>
</ion-content>