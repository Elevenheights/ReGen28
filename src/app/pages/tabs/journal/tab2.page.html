<!-- Header -->
<header class="bg-white border-b border-neutral-200 px-4 py-3">
	<div class="flex items-center justify-between">
		<div class="flex items-center space-x-3">
			<img [src]="profileImageUrl" [alt]="userDisplayName + ' profile'" class="w-8 h-8 rounded-full object-cover"
				(error)="onImageError($event)" (load)="onImageLoad($event)">
			<div>
				<h1 class="text-lg text-neutral-900">My Journal</h1>
				<p class="text-xs text-neutral-500">Your sacred space for reflection</p>
			</div>
		</div>
		<button class="p-2" (click)="onSearchEntries()">
			<i class="fa-solid fa-search text-neutral-600"></i>
		</button>
	</div>
</header>

<ion-content class="bg-neutral-50">
	<!-- Main Content -->
	<main class="px-4 py-6 pb-24">
		<!-- Journal Stats -->
		<section class="mb-6">
			<app-journal-stats [stats]="journalStats" [isLoading]="isLoadingStats" [showDetailedStats]="false">
			</app-journal-stats>
		</section>

		<!-- New Entry Button -->
		<section class="mb-6">
			<button class="w-full bg-neutral-900 text-white rounded-2xl p-4 flex items-center justify-center space-x-3"
				(click)="onWriteNewEntry()">
				<i class="fa-solid fa-plus text-lg"></i>
				<span class="text-base">Write New Entry</span>
			</button>
		</section>

		<!-- Journal Prompts -->
		<app-journal-prompts [prompts]="journalPrompts" [dailyPrompt]="dailyPrompt"
			[isLoadingPrompts]="isLoadingPrompts" [isLoadingDailyPrompt]="isLoadingDailyPrompt"
			[isRefreshing]="isRefreshingPrompts" (promptSelected)="onPromptSelected($event)"
			(refreshPrompts)="onRefreshPrompts()">
		</app-journal-prompts>


		<!-- Recent Entries -->
		<section class="mb-6">
			<div class="flex items-center justify-between mb-3">
				<h2 class="text-base text-neutral-900">Recent Entries</h2>
				<button class="text-xs text-neutral-500" (click)="onViewAllEntries()">View all</button>
			</div>

			<!-- Loading entries -->
			<div *ngIf="isLoadingEntries" class="space-y-3">
				<div class="bg-neutral-200 rounded-xl h-20 animate-pulse"></div>
				<div class="bg-neutral-200 rounded-xl h-20 animate-pulse"></div>
				<div class="bg-neutral-200 rounded-xl h-20 animate-pulse"></div>
			</div>

			<!-- Loaded entries -->
			<div *ngIf="!isLoadingEntries && recentEntries.length > 0" class="space-y-3">
				<app-journal-entry-card *ngFor="let entry of recentEntries" [entry]="entry" [maxContentLength]="120"
					(entryClick)="onEntryClick($event)" (editClick)="onEntryEdit($event)"
					(deleteClick)="onEntryDelete($event)">
				</app-journal-entry-card>
			</div>

			<!-- No entries -->
			<div *ngIf="!isLoadingEntries && recentEntries.length === 0" class="text-center py-8">
				<div class="mb-4">
					<i class="fa-solid fa-book-open text-neutral-300 text-4xl"></i>
				</div>
				<h3 class="text-lg text-neutral-900 mb-2">Start Your Journey</h3>
				<p class="text-sm text-neutral-500 mb-4">Write your first journal entry to begin tracking your thoughts
					and emotions.</p>
				<button class="bg-neutral-900 text-white px-6 py-2 rounded-xl text-sm" (click)="onWriteNewEntry()">
					Write First Entry
				</button>
			</div>
		</section>

		<!-- Mood Tracker -->
		<section *ngIf="!isLoadingStats && journalStats && journalStats.totalEntries > 0" class="mb-6">
			<app-mood-tracker [weeklyTrends]="weeklyMoodTrends" [isLoading]="isLoadingTrends">
			</app-mood-tracker>
		</section>
	</main>


</ion-content>