<ion-header class="ion-no-border">
	<ion-toolbar class="px-2">
		<ion-buttons slot="start">
			<ion-button (click)="dismiss()" fill="clear" color="medium">
				Cancel
			</ion-button>
		</ion-buttons>
		<ion-title class="text-lg font-semibold text-neutral-900">
			Quick Journal
		</ion-title>
		<ion-buttons slot="end">
			<ion-button (click)="save()" [disabled]="entryForm.invalid || isSaving" fill="clear" color="primary"
				class="font-semibold">
				<ion-spinner *ngIf="isSaving" name="crescent"></ion-spinner>
				<span *ngIf="!isSaving">Save</span>
			</ion-button>
		</ion-buttons>
	</ion-toolbar>
</ion-header>

<ion-content class="ion-padding bg-neutral-50">
	<form [formGroup]="entryForm" class="space-y-6">
		<!-- Header Info -->
		<div *ngIf="prompt" class="bg-purple-50 rounded-2xl p-4 border border-purple-100 mb-6">
			<p class="text-xs font-semibold text-purple-600 uppercase tracking-wider mb-1">Writing Prompt</p>
			<p class="text-sm text-neutral-800 italic leading-relaxed">"{{ prompt.text }}"</p>
		</div>

		<!-- Title and Category -->
		<div class="space-y-4">
			<div class="bg-white rounded-2xl p-4 border border-neutral-100 shadow-sm">
				<label class="text-xs font-bold text-neutral-500 uppercase tracking-widest block mb-1">Title</label>
				<ion-input formControlName="title" placeholder="What's this about?"
					class="text-lg font-medium text-neutral-900" fill="none">
				</ion-input>
			</div>

			<div class="bg-white rounded-2xl p-4 border border-neutral-100 shadow-sm">
				<label class="text-xs font-bold text-neutral-500 uppercase tracking-widest block mb-2">Category</label>
				<div class="flex flex-wrap gap-2">
					<button *ngFor="let cat of categories" type="button"
						(click)="entryForm.patchValue({ category: cat })"
						[class.bg-blue-600]="entryForm.get('category')?.value === cat"
						[class.text-white]="entryForm.get('category')?.value === cat"
						[class.bg-neutral-100]="entryForm.get('category')?.value !== cat"
						[class.text-neutral-600]="entryForm.get('category')?.value !== cat"
						class="px-3 py-1.5 rounded-full text-xs font-medium transition-all duration-200">
						<i class="fa-solid {{ getCategoryIcon(cat) }} mr-1.5"></i>
						{{ cat | titlecase }}
					</button>
				</div>
			</div>
		</div>

		<!-- Content Area -->
		<div class="bg-white rounded-2xl p-4 border border-neutral-100 shadow-sm min-h-[200px]">
			<label class="text-xs font-bold text-neutral-500 uppercase tracking-widest block mb-2">Reflections</label>
			<ion-textarea formControlName="content" placeholder="How was your day? What's on your mind?" rows="8"
				class="text-neutral-800 leading-relaxed font-normal" fill="none">
			</ion-textarea>
		</div>

		<!-- State Tracking -->
		<div class="grid grid-cols-1 gap-4">
			<!-- Mood -->
			<div class="bg-white rounded-2xl p-4 border border-neutral-100 shadow-sm">
				<label class="text-xs font-bold text-neutral-500 uppercase tracking-widest block mb-3">Rate Mood</label>
				<div class="flex justify-between items-center bg-neutral-50 p-3 rounded-xl border border-neutral-100">
					<span class="text-3xl filter drop-shadow-sm">{{ getMoodEmoji(entryForm.get('mood')?.value) }}</span>
					<ion-range formControlName="mood" min="1" max="10" step="1" class="flex-1 px-4" color="primary">
					</ion-range>
					<span class="text-sm font-bold text-neutral-900 w-8 text-right">{{ entryForm.get('mood')?.value
						}}</span>
				</div>
			</div>

			<!-- Energy -->
			<div class="bg-white rounded-2xl p-4 border border-neutral-100 shadow-sm">
				<label class="text-xs font-bold text-neutral-500 uppercase tracking-widest block mb-3">Energy
					Level</label>
				<div class="flex justify-between items-center bg-neutral-50 p-3 rounded-xl border border-neutral-100">
					<i class="fa-solid fa-bolt text-yellow-500 text-xl"></i>
					<ion-range formControlName="energy" min="1" max="5" step="1" class="flex-1 px-4" color="warning">
					</ion-range>
					<span class="text-sm font-bold text-neutral-900 w-8 text-right">{{ entryForm.get('energy')?.value
						}}</span>
				</div>
			</div>
		</div>
	</form>
</ion-content>